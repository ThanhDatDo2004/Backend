# R√Ä SO√ÅT V√Ä B√ÅNG C√ÅO TR·∫°NG TH√ÅI CODE

## üìã Y√äU C·∫¶U V√Ä Q√öID·ªäCH HO·∫†T ƒê·ªòNG (t·ª´ README.md)

Website cho thu√™ s√¢n th·ªÉ thao c√≥ 3 vai tr√≤ ch√≠nh:
- **Kh√°ch h√†ng (Customer/cus)**: ƒê·∫∑t s√¢n
- **Ch·ªß s√¢n (Shop/shop)**: Qu·∫£n l√Ω s√¢n
- **Qu·∫£n l√Ω website (Admin/admin)**: Duy·ªát shop, qu·∫£n l√Ω h·ªá th·ªëng

### Quy tr√¨nh ch√≠nh:
1. Shop ƒëƒÉng k√Ω ‚Üí Admin duy·ªát ‚Üí Shop c√≥ hi·ªáu l·ª±c
2. Kh√°ch h√†ng ƒë·∫∑t s√¢n ‚Üí Thanh to√°n ‚Üí H·ªá th·ªëng x√°c nh·∫≠n
3. Thanh to√°n: Admin nh·∫≠n 100%, sau khi kh√°ch ho√†n th√†nh, 95% g·ª≠i v·ªÅ t√†i kho·∫£n ng√¢n h√†ng shop, 5% gi·ªØ l·∫°i admin
4. Kh√°ch ho√†n th√†nh ‚Üí C√≥ th·ªÉ ƒë√°nh gi√° s√¢n

---

## ‚úÖ C√ÅC PH·∫¶N ƒê√É HO√ÄN TH√ÄNH

### 1. **H·ªá Th·ªëng X√°c Th·ª±c & Ph√¢n Quy·ªÅn (A - Users & Roles)**
- ‚úÖ **Login**: H·ªó tr·ª£ email/phone, m·∫≠t kh·∫©u ƒë∆∞·ª£c hash bcrypt
  - File: `auth.controller.ts` (lines 28-117)
  - File: `auth.service.ts` (password hashing/verification)
  
- ‚úÖ **ƒêƒÉng K√Ω Kh√°ch H√†ng (Customer Registration)**
  - File: `auth.controller.ts` (lines 308-355 - register function)
  - L∆∞u v√†o database v·ªõi level_code = 'cus'
  
- ‚úÖ **Qu√™n M·∫≠t Kh·∫©u / Reset Password**
  - File: `auth.controller.ts` (lines 202-298)
  - G·ª≠i email v·ªõi JWT token, ng∆∞·ªùi d√πng set m·∫≠t kh·∫©u m·ªõi
  - S·ª≠ d·ª•ng mail.service.ts ƒë·ªÉ g·ª≠i email
  
- ‚úÖ **X√°c Minh Email (OTP)**
  - File: `auth.controller.ts` (lines 120-187)
  - sendCode + verifyCode endpoints
  - L∆∞u OTP trong memory v·ªõi TTL 15 ph√∫t (c√≥ th·ªÉ c·∫£i thi·ªán l∆∞u v√†o DB)
  
- ‚úÖ **Ph√¢n Quy·ªÅn Ng∆∞·ªùi D√πng**
  - File: `Users_Level` table - 3 m·ª©c: cus, shop, admin
  - Middleware: `auth.middleware.ts` - x√°c th·ª±c JWT token
  - L∆∞u role trong JWT payload

### 2. **Qu·∫£n L√Ω Shop (B - Shops & Bank Accounts)**
- ‚úÖ **Y√™u C·∫ßu M·ªü Shop**
  - File: `shop.controller.ts` - submitRequest (lines 22-51)
  - File: `shopApplication.service.ts` - createRequest
  - L∆∞u v√†o `Shop_Applications` table
  - G·ª≠i email th√¥ng b√°o (sendShopRequestEmail)

- ‚úÖ **Admin Duy·ªát/T·ª´ Ch·ªëi Shop Request**
  - File: `admin.controller.ts` - updateShopRequestStatus (lines 148-217)
  - File: `admin.service.ts` - updateShopRequestStatus (lines 340-461)
  - T·ª± ƒë·ªông t·∫°o shop v√† c·∫≠p nh·∫≠t user level th√†nh 'shop'
  
- ‚úÖ **C·∫≠p Nh·∫≠t Th√¥ng Tin Shop**
  - File: `shop.controller.ts` - updateMe (lines 53-95)
  - File: `shop.service.ts` - updateByUserId (lines 91-180)
  - H·ªó tr·ª£ c·∫≠p nh·∫≠t t√™n, ƒë·ªãa ch·ªâ, t√†i kho·∫£n ng√¢n h√†ng
  
- ‚úÖ **L·∫•y Th√¥ng Tin Shop Hi·ªán T·∫°i**
  - File: `shop.controller.ts` - current (lines 97-120)
  - File: `shop.service.ts` - getByUserId, getByCode
  
- ‚úÖ **L∆∞u T√†i Kho·∫£n Ng√¢n H√†ng Shop**
  - File: `Shop_Bank_Accounts` table
  - Trong updateByUserId, t·ª± ƒë·ªông th√™m/c·∫≠p nh·∫≠t t√†i kho·∫£n m·∫∑c ƒë·ªãnh

### 3. **Qu·∫£n L√Ω S√¢n (C - Fields, Pricing & Slots)**
- ‚úÖ **T·∫°o S√¢n (Shop Owner)**
  - File: `shopField.controller.ts` - createForMe/create
  - File: `field.model.ts` - insertField
  - H·ªó tr·ª£ upload h√¨nh ·∫£nh (Field_Images)
  
- ‚úÖ **Danh S√°ch S√¢n (C√¥ng Khai)**
  - File: `field.controller.ts` - list (lines 24-116)
  - File: `field.service.ts` - list
  - H·ªó tr·ª£ filter: search, sportType, location, price, status
  - H·ªó tr·ª£ sort: price, rating, name
  - Pagination
  
- ‚úÖ **Chi Ti·∫øt S√¢n**
  - File: `field.controller.ts` - detail (lines 118-141)
  - File: `field.service.ts` - getById
  - Tr·∫£ v·ªÅ ƒë·∫ßy ƒë·ªß info: gi√°, h√¨nh ·∫£nh, ƒë√°nh gi√°, th√¥ng tin shop
  
- ‚úÖ **T·∫£i ·∫¢nh S√¢n**
  - File: `field.controller.ts` - uploadImage (lines 143-176)
  - File: `upload.middleware.ts` - fieldImageUpload
  - H·ªó tr·ª£ local storage ho·∫∑c S3
  
- ‚úÖ **C·∫≠p Nh·∫≠t S√¢n**
  - File: `shopField.controller.ts` - updateForMe/update
  - File: `field.model.ts` - updateField
  
- ‚úÖ **X√≥a S√¢n (Soft Delete)**
  - File: `shopField.controller.ts` - removeForMe
  - File: `field.model.ts` - softDeleteField (c·∫≠p nh·∫≠t status = 'inactive')

### 4. **Gi√° & Khung Gi·ªù (Pricing & Slots)**
- ‚úÖ **Qu·∫£n L√Ω Gi√° Theo Ng√†y/Gi·ªù**
  - File: `pricing.controller.ts` - CRUD operations
  - File: `Field_Pricing` table - DayOfWeek, StartTime, EndTime, PricePerHour
  
- ‚úÖ **Xem Khung Gi·ªù Tr·ªëng**
  - File: `field.controller.ts` - availability (lines 178-210)
  - File: `field.service.ts` - getAvailability
  - Tr·∫£ v·ªÅ slots available/booked/held/blocked

### 5. **ƒê·∫∑t S√¢n & Thanh To√°n (D - Bookings & Payments)**
- ‚úÖ **X√°c Nh·∫≠n ƒê·∫∑t S√¢n**
  - File: `field.controller.ts` - confirmBooking (lines 212-255)
  - File: `booking.service.ts` - confirmFieldBooking (lines 218-281)
  - T·∫°o booking record, c·∫≠p nh·∫≠t slot status ‚Üí 'booked'
  - Tr·∫£ v·ªÅ booking_code + transaction_id (mock)
  
- ‚úÖ **T·∫°o Field_Slots**
  - T·ª± ƒë·ªông t·∫°o khi x√°c nh·∫≠n booking n·∫øu slot ch∆∞a t·ªìn t·∫°i
  - H·ªó tr·ª£ lock (FOR UPDATE) ƒë·ªÉ tr√°nh race condition
  
- ‚ö†Ô∏è **Thanh To√°n (MOCK - Ch∆∞a Th·ª±c Hi·ªán Th·ª±c)**
  - File: `booking.service.ts` - confirmFieldBooking tr·∫£ v·ªÅ `payment_status: "mock_success"`
  - ‚ùå Ch∆∞a integrate th·ª±c payment gateway (Momo, bank transfer, etc.)
  - ‚ùå Ch∆∞a t·∫°o record trong `Payments_Admin` table
  - ‚ùå Ch∆∞a x·ª≠ l√Ω t√≠nh to√°n fee (5% platform fee, 95% to shop)

### 6. **Admin Panel**
- ‚úÖ **Li·ªát K√™ Shop**
  - File: `admin.controller.ts` - listShops (lines 17-29)
  - File: `admin.service.ts` - listShops (lines 243-313)
  
- ‚úÖ **Li·ªát K√™ Ng∆∞·ªùi D√πng**
  - File: `admin.controller.ts` - listUsers (lines 31-43)
  - File: `admin.service.ts` - listUsers (lines 139-159)
  
- ‚úÖ **Qu·∫£n L√Ω Tr·∫°ng Th√°i Ng∆∞·ªùi D√πng (Lock/Unlock)**
  - File: `admin.controller.ts` - updateUserStatus (lines 59-105)
  - File: `admin.service.ts` - updateUserStatus (lines 182-241)
  
- ‚úÖ **Li·ªát K√™ Shop Request**
  - File: `admin.controller.ts` - listShopRequests (lines 107-119)
  - File: `admin.service.ts` - listShopRequests (lines 315-324)

---

## ‚ùå C√ÅC PH·∫¶N CH∆ØA HO√ÄN TH√ÄNH HO·∫∂C C·∫¶N C·∫¢I THI·ªÜN

### 1. **Thanh To√°n (Payment System)** - ‚ö†Ô∏è QUAN TR·ªåNG
- ‚ùå **M·ª•c ƒê√≠ch**: Theo README: "Khi h·ªá th·ªëng x√°c nh·∫≠n ƒë√£ thanh to√°n th√†nh c√¥ng th√¨ s·ªë ti·ªÅn ho√†n to√†n g·ª≠i v·ªÅ t√†i kho·∫£n ng√¢n h√†ng admin"
- **V·∫•n ƒê·ªÅ**:
  - Ch·ªâ c√≥ mock payment, kh√¥ng t√≠ch h·ª£p th·ª±c
  - Kh√¥ng t·∫°o record `Payments_Admin` trong database
  - Kh√¥ng t√≠nh to√°n fee (5% admin, 95% shop)
  - Kh√¥ng c√≥ `Wallet_Transactions` record
  - Kh√¥ng c√≥ `Payout_Requests` cho shop
  - Ch∆∞a c√≥ QR code Momo nh∆∞ y√™u c·∫ßu README
  
- **C·∫ßn Implement**:
  1. T√≠ch h·ª£p Momo/payment gateway
  2. T·∫°o `Payments_Admin` record khi thanh to√°n th√†nh c√¥ng
  3. C·∫≠p nh·∫≠t `Shop_Wallets` balance
  4. T·∫°o `Wallet_Transactions` record
  5. Chu·∫©n b·ªã `Payout_Requests` cho shop y√™u c·∫ßu r√∫t ti·ªÅn

### 2. **R√∫t Ti·ªÅn (Payout)** - ‚ùå KH√îNG C√ì
- **V·∫•n ƒê·ªÅ**:
  - Ch∆∞a c√≥ endpoint ƒë·ªÉ shop y√™u c·∫ßu r√∫t ti·ªÅn
  - Ch∆∞a c√≥ endpoint ƒë·ªÉ admin duy·ªát r√∫t ti·ªÅn
  - Ch∆∞a c√≥ logic t√≠nh to√°n 95% net to shop
  - Ch∆∞a c√≥ `Payout_Requests` management
  
- **C·∫ßn Implement**:
  1. POST `/api/shops/me/payout-requests` - T·∫°o y√™u c·∫ßu r√∫t ti·ªÅn
  2. GET `/api/shops/me/payout-requests` - Li·ªát k√™ y√™u c·∫ßu r√∫t ti·ªÅn
  3. GET `/api/admin/payout-requests` - Admin li·ªát k√™ r√∫t ti·ªÅn
  4. PATCH `/api/admin/payout-requests/:id/approve` - Duy·ªát r√∫t ti·ªÅn
  5. PATCH `/api/admin/payout-requests/:id/reject` - T·ª´ ch·ªëi r√∫t ti·ªÅn

### 3. **V√≠ Shop (Shop Wallet)** - ‚ö†Ô∏è CH∆ØA ƒê·∫¶Y ƒê·ª¶
- ‚ö†Ô∏è **V·∫•n ƒê·ªÅ**:
  - Table `Shop_Wallets` t·ªìn t·∫°i nh∆∞ng ch∆∞a ƒë∆∞·ª£c s·ª≠ d·ª•ng
  - Kh√¥ng c√≥ endpoint GET wallet balance
  - Kh√¥ng c√≥ transaction history
  
- **C·∫ßn Implement**:
  1. GET `/api/shops/me/wallet` - L·∫•y balance hi·ªán t·∫°i
  2. GET `/api/shops/me/wallet/transactions` - L·ªãch s·ª≠ giao d·ªãch

### 4. **ƒê√°nh Gi√° (Reviews)** - ‚ö†Ô∏è CH∆ØA IMPLEMENT
- ‚ùå **V·∫•n ƒê·ªÅ**:
  - Table `Reviews` t·ªìn t·∫°i nh∆∞ng kh√¥ng c√≥ endpoint
  - Kh√¥ng c√≥ endpoint t·∫°o review
  - Kh√¥ng c√≥ endpoint li·ªát k√™ review
  
- **C·∫ßn Implement**:
  1. POST `/api/fields/:id/reviews` - T·∫°o review (y√™u c·∫ßu auth + ƒë√£ booking)
  2. GET `/api/fields/:id/reviews` - Li·ªát k√™ review
  3. X√°c th·ª±c: Ch·ªâ ƒë∆∞·ª£c review sau khi booking completed

### 5. **Th√¥ng B√°o (Notifications)** - ‚ùå KH√îNG C√ì
- ‚ùå **V·∫•n ƒê·ªÅ**:
  - Table `Notifications` t·ªìn t·∫°i nh∆∞ng ch∆∞a ƒë∆∞·ª£c s·ª≠ d·ª•ng
  - Kh√¥ng c√≥ endpoint ƒë·ªÉ l·∫•y/qu·∫£n l√Ω th√¥ng b√°o
  - Kh√¥ng c√≥ logic t·∫°o th√¥ng b√°o khi c√≥ events
  
- **C·∫ßn Implement**:
  1. GET `/api/notifications` - Li·ªát k√™ th√¥ng b√°o c·ªßa user
  2. PATCH `/api/notifications/:id/read` - ƒê√°nh d·∫•u ƒë√£ ƒë·ªçc
  3. T·ª± ƒë·ªông t·∫°o th√¥ng b√°o khi:
     - Booking ƒë∆∞·ª£c t·∫°o ‚Üí g·ª≠i cho shop
     - Thanh to√°n th√†nh c√¥ng ‚Üí g·ª≠i cho customer + shop
     - R√∫t ti·ªÅn ƒë∆∞·ª£c duy·ªát ‚Üí g·ª≠i cho shop

### 6. **Checkout Code (M√£ x√°c nh·∫≠n)** - ‚ö†Ô∏è CH∆ØA IMPLEMENT
- ‚ö†Ô∏è **V·∫•n ƒê·ªÅ**:
  - Column `CheckinCode` t·ªìn t·∫°i trong `Bookings` table nh∆∞ng ch∆∞a s·ª≠ d·ª•ng
  - README y√™u c·∫ßu: "Thanh to√°n th√†nh c√¥ng s·∫Ω hi·ªán ra m√£ code cho kh√°ch h√†ng l∆∞u"
  - Kh√¥ng c√≥ endpoint ƒë·ªÉ verify checkin code
  
- **C·∫ßn Implement**:
  1. T·∫°o unique CheckinCode khi booking th√†nh c√¥ng
  2. POST `/api/bookings/:id/verify-checkin` - Verify checkin code

### 7. **Booking Status Management** - ‚ö†Ô∏è CH∆ØA ƒê·∫¶Y ƒê·ª¶
- ‚ö†Ô∏è **V·∫•n ƒê·ªÅ**:
  - Column `BookingStatus` c√≥ nh∆∞ng logic chuy·ªÉn ƒë·ªïi tr·∫°ng th√°i ch∆∞a ho√†n thi·ªán
  - Ch·ªâ c√≥ 'pending' ‚Üí 'booked', kh√¥ng c√≥ 'completed', 'cancelled'
  - Kh√¥ng c√≥ endpoint ƒë·ªÉ c·∫≠p nh·∫≠t tr·∫°ng th√°i booking
  - Kh√¥ng c√≥ logic t·ª± ƒë·ªông chuy·ªÉn 'booked' ‚Üí 'completed' sau th·ªùi gian
  
- **C·∫ßn Implement**:
  1. PATCH `/api/bookings/:id/status` - C·∫≠p nh·∫≠t tr·∫°ng th√°i (admin/shop)
  2. Scheduled job ƒë·ªÉ auto-complete booking sau th·ªùi gian
  3. PATCH `/api/bookings/:id/cancel` - H·ªßy booking (tr∆∞·ªõc 2h)

### 8. **Email Verification (Setup Database)** - ‚ö†Ô∏è CH∆ØA HO√ÄN THI·ªÜN
- ‚ö†Ô∏è **V·∫•n ƒê·ªÅ**:
  - Table `Users_Verification` t·ªìn t·∫°i nh∆∞ng OTP l∆∞u trong memory
  - Endpoint `/api/auth/verify-email` ch·ªâ tr·∫£ v·ªÅ th√†nh c√¥ng m√† kh√¥ng verify g√¨
  - Kh√¥ng check email ƒë√£ ƒë∆∞·ª£c verify hay ch∆∞a
  
- **N√™n C·∫£i Thi·ªán**:
  1. L∆∞u OTP v√†o database thay v√¨ memory
  2. Implement th·ª±c verify email v√†o b∆∞·ªõc register
  3. Check `Users_Verification.Consumed` tr∆∞·ªõc khi cho ƒëƒÉng nh·∫≠p

### 9. **Refresh Token** - ‚ö†Ô∏è CH∆ØA IMPLEMENT
- ‚ö†Ô∏è **V·∫•n ƒê·ªÅ**:
  - JWT service c√≥ generateRefreshToken nh∆∞ng kh√¥ng c√≥ endpoint
  - Kh√¥ng c√≥ c∆° ch·∫ø refresh token
  
- **C·∫ßn Implement**:
  1. POST `/api/auth/refresh-token` - L·∫•y access token m·ªõi t·ª´ refresh token

### 10. **Validation & Error Handling** - ‚ö†Ô∏è CH∆ØA ƒê·∫¶Y ƒê·ª¶
- ‚ö†Ô∏è **V·∫•n ƒê·ªÅ**:
  - M·ªôt s·ªë endpoint kh√¥ng validate ƒë·∫ßy ƒë·ªß input
  - M·ªôt s·ªë error message kh√¥ng r√µ r√†ng
  - Kh√¥ng c√≥ consistent error response format
  
- **N√™n C·∫£i Thi·ªán**:
  1. Th√™m zod validation cho t·∫•t c·∫£ endpoints
  2. ƒê·ªãnh nghƒ©a clear error codes v√† messages
  3. Standardize error response format

### 11. **Upload File Management** - ‚ö†Ô∏è CH∆ØA HO√ÄN THI·ªÜN
- ‚ö†Ô∏è **V·∫•n ƒê·ªÅ**:
  - S3 service t·ªìn t·∫°i nh∆∞ng kh√¥ng r√µ configuration
  - Kh√¥ng c√≥ cleanup c≈© images khi x√≥a s√¢n
  - File path validation c√≥ th·ªÉ c·∫ßn c·∫£i thi·ªán
  
- **N√™n C·∫£i Thi·ªán**:
  1. Test S3 upload/download
  2. Th√™m image size validation
  3. Cleanup S3 files khi x√≥a s√¢n (soft delete)

### 12. **Field Slots Pre-generation** - ‚ö†Ô∏è CH∆ØA IMPLEMENT
- ‚ö†Ô∏è **V·∫•n ƒê·ªÅ**:
  - Hi·ªán t·∫°i slot ch·ªâ t·∫°o khi booking
  - Kh√¥ng c√≥ c∆° ch·∫ø pre-generate slots theo pricing rules
  - Kh√¥ng c√≥ endpoint ƒë·ªÉ shop setup operating hours t·ª± ƒë·ªông t·∫°o slots
  
- **N√™n C·∫£i Thi·ªán**:
  1. Th√™m job schedule generate slots t·ª´ pricing + date range
  2. Shop c√≥ th·ªÉ t·∫°o "blocked" slots cho maintenance

### 13. **Transaction & Race Condition** - ‚ö†Ô∏è CH∆ØA ƒê·∫¶Y ƒê·ª¶
- ‚ö†Ô∏è **V·∫•n ƒê·ªÅ**:
  - confirmFieldBooking s·ª≠ d·ª•ng transaction + FOR UPDATE
  - Nh∆∞ng kh√¥ng c√≥ retry logic n·∫øu transaction fail
  - Kh√¥ng c√≥ deadlock handling
  
- **N√™n C·∫£i Thi·ªán**:
  1. Th√™m retry mechanism
  2. Better error handling cho transaction failures

### 14. **Pricing Service** - ‚ö†Ô∏è CH∆ØA HO√ÄN THI·ªÜN
- ‚ö†Ô∏è **V·∫•n ƒê·ªÅ**:
  - File `pricing.service.ts` t·ªìn t·∫°i nh∆∞ng kh√¥ng t√¨m th·∫•y n√≥
  - C·∫ßn xem logic t√≠nh gi√° d·ª±a tr√™n DayOfWeek, StartTime, EndTime
  
- **N√™n C·∫£i Thi·ªán**:
  1. Verify pricing calculation logic
  2. Handle default price fallback

### 15. **Admin Bank Accounts** - ‚ö†Ô∏è CH∆ØA QU·∫¢N L√ù
- ‚ùå **V·∫•n ƒê·ªÅ**:
  - Table `Admin_Bank_Accounts` t·ªìn t·∫°i nh∆∞ng kh√¥ng c√≥ endpoint
  - Admin kh√¥ng th·ªÉ setup bank account ƒë·ªÉ nh·∫≠n ti·ªÅn
  
- **C·∫ßn Implement**:
  1. GET `/api/admin/bank-accounts` - Li·ªát k√™
  2. POST `/api/admin/bank-accounts` - T·∫°o
  3. PUT `/api/admin/bank-accounts/:id` - C·∫≠p nh·∫≠t

---

## üìä T√ìMT T·∫ÆT T√åNH TR·∫†NG

| Ph·∫ßn | Tr·∫°ng Th√°i | M·ª©c ƒê·ªô ∆Øu Ti√™n |
|------|----------|----------------|
| **Authentication** | ‚úÖ Ho√†n th√†nh | - |
| **User Roles** | ‚úÖ Ho√†n th√†nh | - |
| **Shop Management** | ‚úÖ Ho√†n th√†nh | - |
| **Field CRUD** | ‚úÖ Ho√†n th√†nh | - |
| **Pricing** | ‚ö†Ô∏è T·∫°o ƒë∆∞·ª£c nh∆∞ng validation ch∆∞a ƒë·∫ßy ƒë·ªß | Medium |
| **Field Slots** | ‚úÖ Ho√†n th√†nh (t·∫°o khi booking) | - |
| **Booking** | ‚ö†Ô∏è Ho√†n th√†nh nh∆∞ng ch∆∞a ƒë·∫ßy ƒë·ªß flow | High |
| **Payment System** | ‚ùå Mock only, ch∆∞a th·ª±c | üî¥ CRITICAL |
| **Payout/R√∫t ti·ªÅn** | ‚ùå Kh√¥ng c√≥ | üî¥ CRITICAL |
| **Shop Wallet** | ‚ö†Ô∏è Table t·ªìn t·∫°i nh∆∞ng ch∆∞a d√πng | High |
| **Reviews** | ‚ùå Kh√¥ng c√≥ | Medium |
| **Notifications** | ‚ùå Kh√¥ng c√≥ | Medium |
| **CheckinCode** | ‚ö†Ô∏è Ch∆∞a implement | Low |
| **Email Verification** | ‚ö†Ô∏è Logic ch∆∞a ho√†n thi·ªán | Medium |
| **Refresh Token** | ‚ùå Kh√¥ng c√≥ endpoint | Low |
| **Admin Bank Accounts** | ‚ùå Kh√¥ng c√≥ management | High |

---

## üî¥ NH·ªÆNG PH·∫¶N QUAN TR·ªåNG C·∫¶N ∆ØU TI√äN

### C·∫•p ƒë·ªô CRITICAL (Must-Have):
1. **Payment System** - T√≠ch h·ª£p th·ª±c payment gateway + t√≠nh fee
2. **Payout System** - Cho ph√©p shop r√∫t ti·ªÅn + admin qu·∫£n l√Ω
3. **Booking Status Flow** - Ho√†n thi·ªán tr·∫°ng th√°i booking (pending ‚Üí confirmed ‚Üí completed)

### C·∫•p ƒë·ªô HIGH (Should-Have):
1. **Admin Bank Accounts Management** - Setup t√†i kho·∫£n nh·∫≠n ti·ªÅn
2. **Shop Wallet** - Xem balance + transaction history
3. **CheckinCode** - M√£ x√°c nh·∫≠n khi thanh to√°n
4. **Notifications** - Th√¥ng b√°o c√°c events

### C·∫•p ƒë·ªô MEDIUM (Nice-to-Have):
1. **Reviews** - ƒê√°nh gi√° s√¢n
2. **Email Verification DB** - L∆∞u OTP v√†o DB thay v√¨ memory
3. **Pre-generate Slots** - T·ª± ƒë·ªông t·∫°o slots theo pricing

### C·∫•p ƒë·ªô LOW (Future):
1. **Refresh Token Endpoint** - JWT refresh mechanism
2. **Advanced Validations** - To√†n b·ªô input validation
3. **Transaction Retry** - Better error handling

---

## üéØ KHUY·∫æN NGH·ªä TI·∫æP THEO

1. **T·∫°o Payment Service** - T√≠ch h·ª£p Momo ho·∫∑c payment gateway kh√°c
2. **Implement Payout Logic** - T√≠nh to√°n fee + transfer to shop bank
3. **Create Notification System** - K√≠ch ho·∫°t khi c√≥ events
4. **Complete Booking Lifecycle** - T·ª´ pending ‚Üí completed ‚Üí review
5. **Add Comprehensive Testing** - Unit + integration tests
