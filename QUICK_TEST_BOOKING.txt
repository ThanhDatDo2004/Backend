â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                           â•‘
â•‘                  ğŸ“® QUICK BOOKING TEST - POSTMAN GUIDE                   â•‘
â•‘                                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”— TWO API ENDPOINTS:

1ï¸âƒ£  CREATE BOOKING (Tá»« Booking Page)
   Endpoint: POST /api/bookings/create
   Purpose: User chá»n sÃ¢n + khung giá» â†’ Táº¡o booking

2ï¸âƒ£  CONFIRM BOOKING (Tá»« Payment Result)
   Endpoint: POST /api/field/68/confirm
   Purpose: Sau khi thanh toÃ¡n â†’ Confirm booking

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“‹ TEST 1: SINGLE COURT - SINGLE SLOT

Endpoint: POST /api/bookings/create

Body:
{
  "fieldCode": 68,
  "quantity_id": 22,
  "playDate": "2025-10-21",
  "startTime": "08:00",
  "endTime": "09:00",
  "customerName": "Nguyá»…n VÄƒn A",
  "customerEmail": "a@example.com",
  "customerPhone": "0123456789"
}

Expected Response:
{
  "success": true,
  "statusCode": 201,
  "data": {
    "bookingCode": 80,
    "totalPrice": 100000,
    "fieldName": "SÃ¢n 00"
  }
}

Database Result:
âœ… Bookings.QuantityID = 22
âœ… Bookings.PaymentStatus = 'pending'
âœ… Field_Slots.QuantityID = 22
âœ… Field_Slots.Status = 'held'

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“‹ TEST 2: SAME COURT AGAIN - SHOULD FAIL

Endpoint: POST /api/bookings/create

Body:
{
  "fieldCode": 68,
  "quantity_id": 22,
  "playDate": "2025-10-21",
  "startTime": "08:00",
  "endTime": "09:00",
  "customerName": "Nguyá»…n VÄƒn B",
  "customerEmail": "b@example.com",
  "customerPhone": "0987654321"
}

Expected Response:
{
  "success": false,
  "statusCode": 409,
  "error": {
    "message": "SÃ¢n nÃ y Ä‘Ã£ Ä‘Æ°á»£c Ä‘áº·t trong khung giá» nÃ y"
  }
}

âœ… Returns 409 Conflict (correct!)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“‹ TEST 3: DIFFERENT COURT - SAME TIME - SHOULD SUCCESS

Endpoint: POST /api/bookings/create

Body:
{
  "fieldCode": 68,
  "quantity_id": 24,
  "playDate": "2025-10-21",
  "startTime": "08:00",
  "endTime": "09:00",
  "customerName": "Nguyá»…n VÄƒn C",
  "customerEmail": "c@example.com",
  "customerPhone": "0111111111"
}

Expected Response:
{
  "success": true,
  "statusCode": 201,
  "data": {
    "bookingCode": 81,
    "totalPrice": 100000
  }
}

Database Result:
âœ… 2 bookings created with different QuantityID
âœ… Bookings: QuantityID 22 & 24
âœ… Field_Slots: QuantityID 22 & 24

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“‹ TEST 4: MULTIPLE SLOTS - SAME COURT

Endpoint: POST /api/field/68/confirm

Body:
{
  "slots": [
    {
      "playDate": "2025-10-21",
      "startTime": "10:00",
      "endTime": "11:00"
    },
    {
      "playDate": "2025-10-21",
      "startTime": "11:00",
      "endTime": "12:00"
    }
  ],
  "quantity_id": 23,
  "total_price": 200000,
  "payment_method": "bank_transfer",
  "customer": {
    "name": "Nguyá»…n VÄƒn D",
    "email": "d@example.com",
    "phone": "0222222222"
  }
}

Expected Response:
{
  "success": true,
  "statusCode": 200,
  "data": {
    "booking_code": "82",
    "transaction_id": "TXABCD1234",
    "slots": [
      { "slot_id": 1, "start_time": "10:00", "end_time": "11:00" },
      { "slot_id": 2, "start_time": "11:00", "end_time": "12:00" }
    ]
  }
}

Database Result:
âœ… 2 Field_Slots created with same QuantityID (23)
âœ… Bookings.QuantityID = 23
âœ… Field_Slots.Status = 'held'

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ”‘ IMPORTANT NOTES:

1. quantity_id (lowercase!) - NOT quantityID
   âœ… Correct: "quantity_id": 22
   âŒ Wrong: "quantityID": 22

2. Authorization Header Required:
   Authorization: Bearer YOUR_TOKEN

3. After each test, check database:
   SELECT * FROM Bookings WHERE BookingCode = XX;
   SELECT * FROM Field_Slots WHERE BookingCode = XX;

4. Available Quantities API:
   GET /api/fields/68/available-quantities?playDate=2025-10-21&startTime=08:00&endTime=09:00
   
   Shows availableCount changes:
   - Start: 4 (all available)
   - After Test 1: 3 (Court 22 booked)
   - After Test 3: 2 (Court 22 & 24 booked)

5. Field_Slots.Status values:
   - 'available' = CÃ²n trá»‘ng
   - 'held' = Äang giá»¯ (15 phÃºt)
   - 'booked' = ÄÃ£ Ä‘Æ°á»£c Ä‘áº·t

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ… TEST RESULTS SUMMARY:

Test 1 âœ… Single court booked
Test 2 âœ… Same court blocked (409)
Test 3 âœ… Different court allowed
Test 4 âœ… Multiple slots same court

âœ… QuantityID tracking works!
âœ… Availability checks work!
âœ… Backend ready for frontend!

Full details: POSTMAN_CONFIRM_BOOKING.md

